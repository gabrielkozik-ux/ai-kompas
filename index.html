<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Kompas: Zjistěte svůj Archetyp</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #4A90E2; --primary-color-light: #E9F2FC; --dark-color: #222; --light-color: #fff;
            --gray-color: #f4f4f4; --text-color: #333; --muted-color: #666; --border-color: #ddd;
            --border-radius: 8px; --box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            --ok:#28a745; --warn:#ffc107; --err:#dc3545;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Inter', sans-serif; background-color: var(--gray-color); color: var(--text-color); display: flex; justify-content: center; align-items: flex-start; min-height: 100vh; padding: 20px; }
        .container { width: 100%; max-width: 700px; background-color: var(--light-color); border-radius: var(--border-radius); box-shadow: var(--box-shadow); overflow: hidden; }
        section { padding: 40px 50px; text-align: center; }
        .hidden { display: none !important; }
        h1 { font-size: 2.4rem; margin-bottom: 15px; color: var(--dark-color); }
        h2 { font-size: 2rem; margin-bottom: 25px; }
        h3 { font-size: 1.5rem; margin-top: 40px; margin-bottom: 20px; border-top: 1px solid #eee; padding-top: 30px; }
        h4 { font-size: 1.4rem; }
        p { font-size: 1.1rem; line-height: 1.6; margin-bottom: 30px; color: var(--muted-color); }
        .btn { display: inline-block; background-color: var(--primary-color); color: var(--light-color); padding: 14px 28px; border: none; border-radius: var(--border-radius); font-size: 1rem; font-weight: 600; cursor: pointer; text-decoration: none; transition: background-color 0.3s ease, transform 0.2s ease; }
        .btn:hover { background-color: #357ABD; transform: translateY(-2px); }
        .btn.secondary { background-color: #e9ecef; color: var(--dark-color); border: 1px solid #ced4da; }
        .btn.secondary:hover { background-color: #dee2e6; }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
        #quiz #progress-bar { height: 8px; background-color: #e9ecef; border-radius: 99px; overflow: hidden; margin-bottom: 20px; }
        #quiz #progress-bar > div { height: 100%; width: 0%; background-color: var(--primary-color); transition: width 0.3s ease; }
        #quiz #step-pill { font-size: 0.9rem; color: #888; margin-bottom: 10px; font-weight: 600; }
        #answers-container { display: flex; flex-direction: column; gap: 15px; margin-top: 30px; }
        .answer-btn { width: 100%; background-color: var(--light-color); color: var(--primary-color); border: 2px solid #ced4da; text-align: left; padding: 20px; font-size: 1rem; font-weight: 400; transition: border-color 0.2s ease, background-color 0.2s ease, transform 0.2s ease; }
        .answer-btn:hover { background-color: var(--primary-color-light); }
        .answer-btn.selected { border-color: var(--primary-color); background-color: var(--primary-color-light); font-weight: 600; }
        #quiz-nav { display: flex; justify-content: space-between; margin-top: 30px; align-items: center; }
        .result-card { background: var(--light-color); border: 1px solid var(--border-color); border-radius: var(--border-radius); padding: 25px; text-align: left; margin-bottom: 20px; transition: box-shadow 0.3s ease; }
        .result-card:hover { box-shadow: 0 6px 20px rgba(0,0,0,0.08); }
        .result-card.primary { border-left: 5px solid var(--primary-color); background-color: #f8faff; }
        .result-card .header { display: flex; align-items: center; margin-bottom: 15px; justify-content: space-between; flex-wrap: wrap; gap: 10px;}
        .result-card .header-title { display: flex; align-items: center; gap: 15px; }
        .result-card .archetype-pill { font-size: 0.8rem; font-weight: 700; padding: 4px 10px; border-radius: 99px; background-color: var(--primary-color-light); color: var(--primary-color); border: 1px solid var(--primary-color); }
        .result-card .logo-icon { width: 40px; height: 40px; display: grid; place-items: center; background-color: #eee; border-radius: 5px; flex-shrink: 0;}
        .result-card .logo-icon svg { width: 24px; height: 24px; }
        .result-card p { font-size: 1rem; margin-bottom: 10px; }
        .result-card strong { display: block; margin-top: 15px; margin-bottom: 5px; color: var(--dark-color); }
        .score-badge { font-size: 0.85rem; font-weight: 700; padding: 5px 10px; border-radius: 99px; color: white; }
        .score-badge.ok { background-color: var(--ok); } .score-badge.warn { background-color: var(--warn); color: var(--dark-color); } .score-badge.err { background-color: var(--err); }
        .kpi-scores { display: flex; gap: 15px; font-size: 0.9rem; margin-top: 15px; flex-wrap: wrap;}
        #secondary-results, #catalog-list { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        #catalog-toggle { margin: 20px 0; }
        #newsletter { background-color: var(--gray-color); }
        #newsletter-form { display: flex; gap: 10px; justify-content: center; margin-top: 20px; }
        #newsletter-form input { padding: 14px; font-size: 1rem; border-radius: var(--border-radius); border: 1px solid #ccc; width: 100%; max-width: 300px; }
        #newsletter-status { margin-top: 15px; font-size: 0.9rem; height: 20px; }
        .status-ok { color: var(--ok); } .status-err { color: var(--err); }
        footer { padding: 20px; text-align: center; font-size: 0.8rem; color: #aaa; background: var(--dark-color); }
        @media (max-width: 600px) {
            section { padding: 30px 20px; }
            h1 { font-size: 2rem; } h2 { font-size: 1.5rem; }
            #secondary-results, #catalog-list { grid-template-columns: 1fr; }
            #newsletter-form { flex-direction: column; }
            #newsletter-form input { max-width: 100%; }
        }
    </style>
</head>
<body>
    <main class="container">
        <section id="intro">
            <h1>Zjistěte svůj AI Archetyp</h1>
            <p>Tento 5krokový test vám pomůže odhalit, který typ AI nástroje nejlépe odpovídá vašemu pracovnímu stylu a cílům.</p>
            <button id="start-btn" class="btn">Spustit test</button>
        </section>
        <section id="quiz" class="hidden">
            <div id="progress-bar"><div id="progress-bar-inner"></div></div>
            <p id="step-pill"></p>
            <h2 id="question-text"></h2>
            <div id="answers-container"></div>
            <div id="quiz-nav">
                <button id="back-btn" class="btn secondary">← Zpět</button>
                <div style="display:flex; gap:10px">
                    <button id="next-btn" class="btn">Další →</button>
                    <button id="finish-btn" class="btn">Dokončit ✓</button>
                </div>
            </div>
        </section>
        <section id="results" class="hidden">
            <h2 id="results-title">Váš AI Archetyp je:</h2>
            <div id="primary-result"></div>
            <div id="secondary-results-container">
                <h3>Další vhodné nástroje</h3>
                <div id="secondary-results"></div>
            </div>
            <div id="catalog-toggle">
                <button id="show-all-btn" class="btn secondary">Zobrazit přehled všech nástrojů</button>
            </div>
            <div id="catalog" class="hidden">
                <h3>Katalog všech nástrojů</h3>
                <div id="catalog-list"></div>
            </div>
        </section>
        <section id="newsletter">
            <h2>Chcete vědět víc?</h2>
            <p>Zanechte mi svůj e-mail a jednou za měsíc vám pošlu praktické návody a novinky ze světa AI pro živnostníky.</p>
            <form id="newsletter-form">
                <input id="email-input" type="email" placeholder="vas@email.cz" required>
                <button type="submit" class="btn">Odebírat</button>
            </form>
            <p id="newsletter-status" role="status" aria-live="polite"></p>
        </section>
    </main>
    <footer>Běží lokálně ve vašem prohlížeči. Žádná citlivá data neodesíláme.</footer>
    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const JSON_PATH = "./ai_tools.json";
        const NEWSLETTER_ENDPOINT = "";
        const quizQuestions = [
            {
                key: "Q1",
                title: "Co je vaším hlavním cílem?",
                answers: {
                    A: "Tvorba obsahu a marketing",
                    B: "Analýza dat a rešerše",
                    C: "Automatizace a efektivita"
                }
            },
            {
                key: "Q2",
                title: "S jakými zdroji informací nejčastěji pracujete?",
                answers: {
                    A: "S veřejnými informacemi z internetu",
                    B: "S vlastními dokumenty, soubory a daty",
                    C: "Kombinací obojího, propojuji interní a externí data"
                }
            },
            {
                key: "Q3",
                title: "Jaký je váš postoj k riziku a přesnosti?",
                answers: {
                    A: "Preferuji rychlost a kreativitu, drobné nepřesnosti nevadí.",
                    B: "Potřebuji solidní přesnost, ale důvěřuji své kontrole.",
                    C: "Vyžaduji maximální přesnost a ověřitelné zdroje."
                }
            },
            {
                key: "Q4",
                title: "Jaký styl výstupu preferujete?",
                answers: {
                    A: "Originální, kreativní a někdy až překvapivý.",
                    B: "Strukturovaný, jasný a věcný.",
                    C: "Formální, konzistentní a připravený pro integraci."
                }
            },
            {
                key: "Q5",
                title: "Jaký je váš vztah k technologiím?",
                answers: {
                    A: "Chci jednoduchý nástroj, který funguje na kliknutí.",
                    B: "Nevadí mi se učit nové funkce a postupy.",
                    C: "Rád si věci přizpůsobuji, propojuji přes API a automatizuji."
                }
            }
        ];

        const WEIGHTS = {
            Q1: { // Cíl
                A: { chatgpt: 3, gemini: 2, claude: 1 },
                B: { perplexity: 3, gemini: 2, grok: 2, claude: 1 },
                C: { claude: 3, chatgpt: 2, gemini: 1 }
            },
            Q2: { // Zdroje
                A: { perplexity: 3, grok: 3, gemini: 1 },
                B: { claude: 3, gemini: 2, chatgpt: 2 },
                C: { gemini: 3, chatgpt: 2, perplexity: 1 }
            },
            Q3: { // Riziko
                A: { chatgpt: 3, grok: 2 },
                B: { gemini: 3, claude: 2, chatgpt: 1 },
                C: { perplexity: 3, claude: 2, gemini: 1 }
            },
            Q4: { // Styl
                A: { chatgpt: 3, grok: 1 },
                B: { gemini: 3, perplexity: 2, claude: 1 },
                C: { claude: 3, chatgpt: 1, gemini: 1 }
            },
            Q5: { // Technologie
                A: { perplexity: 3, gemini: 2 },
                B: { chatgpt: 3, gemini: 2, claude: 1 },
                C: { claude: 3, chatgpt: 2, grok: 1 }
            }
        };

        const state = { tools: [], answers: {}, qIndex: 0 };
        
        const toolIcons = {
            chatgpt: `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10c.834 0 1.637-.104 2.408-.302.23-.06.477.106.544.33l.267.892c.11.368.5.58.874.47l.805-.24c.37-.11.58-.5.47-.874l-.24-.805c-.11-.37-.5-.58-.874-.47l-1.07.32c-.173.05-.35-.07-.404-.242a8 8 0 1 1 8.01-6.852.25.25 0 0 0-.242.404l.32 1.07c.11.37.5.58.874.47l.805-.24c.37-.11.58-.5.47-.874l-.892-.267a.5.5 0 0 0-.33-.544A10.001 10.001 0 0 0 12 2Z" fill="#75A99C"/></svg>`,
            gemini: `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9.13 11.55a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7ZM15.5 15.05a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7Z" fill="#89B4F8"/><path d="M15.5 22.05a7 7 0 1 0 0-14 7 7 0 0 0 0 14Z" fill="#4285F4"/></svg>`,
            claude: `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2Zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8Z" fill="#D97757"/><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4Z" fill="#D97757"/></svg>`,
            perplexity: `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20Zm0 18a8 8 0 1 1 0-16 8 8 0 0 1 0 16Z" fill="#3B82F6"/><path d="M12 10a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z" fill="#3B82F6"/></svg>`,
            grok: `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10ZM9.5 9a2.5 2.5 0 1 1 0 5 2.5 2.5 0 0 1 0-5Zm5 0a2.5 2.5 0 1 1 0 5 2.5 2.5 0 0 1 0-5Z" fill="#4B5563"/></svg>`,
            default: `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 12a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm0 6a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm0-12a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z" fill="#9CA3AF"/></svg>`
        };

        const $ = (selector) => document.querySelector(selector);
        const $$ = (selector) => document.querySelectorAll(selector);
        const $intro = $('#intro'), $quiz = $('#quiz'), $results = $('#results'), $newsletter = $('#newsletter');
        const $startBtn = $('#start-btn'), $backBtn = $('#back-btn'), $nextBtn = $('#next-btn'), $finishBtn = $('#finish-btn');
        const $questionText = $('#question-text'), $answersContainer = $('#answers-container'), $stepPill = $('#step-pill');
        const $progressBarInner = $('#progress-bar-inner');
        const $primaryResult = $('#primary-result'), $secondaryResults = $('#secondary-results');
        const $showAllBtn = $('#show-all-btn'), $catalog = $('#catalog'), $catalogList = $('#catalog-list');
        const $newsletterForm = $('#newsletter-form'), $emailInput = $('#email-input'), $newsletterStatus = $('#newsletter-status');

        async function init() {
            try {
                const res = await fetch(JSON_PATH, { cache: "no-cache" });
                if (!res.ok) throw new Error(`Chyba načítání dat (${res.status})`);
                state.tools = (await res.json()).tools || [];
                if (state.tools.length === 0) throw new Error("Soubor ai_tools.json neobsahuje žádné nástroje.");
            } catch (err) {
                console.error(err);
                state.tools = getFallbackTools();
                $('#intro p').textContent = "Nepodařilo se načíst data o nástrojích. Používají se záložní data. Test je plně funkční.";
            }
            setupEventListeners();
        }

        function setupEventListeners() {
            $startBtn.addEventListener('click', startQuiz);
            $backBtn.addEventListener('click', onBack);
            $nextBtn.addEventListener('click', onNext);
            $finishBtn.addEventListener('click', onFinish);
            $showAllBtn.addEventListener('click', () => {
                $catalog.classList.toggle('hidden');
                $showAllBtn.textContent = $catalog.classList.contains('hidden') ? "Zobrazit přehled všech nástrojů" : "Skrýt přehled";
            });
            $newsletterForm.addEventListener('submit', onNewsletterSubmit);
        }

        function startQuiz() {
            $intro.classList.add('hidden');
            $results.classList.add('hidden');
            $newsletter.classList.add('hidden');
            $quiz.classList.remove('hidden');
            state.qIndex = 0;
            state.answers = {};
            renderQuestion();
            focusH2($questionText);
        }

        function renderQuestion() {
            const q = quizQuestions[state.qIndex];
            $questionText.textContent = q.title;
            const step = state.qIndex + 1;
            $progressBarInner.style.width = `${(step / quizQuestions.length) * 100}%`;
            $stepPill.textContent = `Krok ${step} / ${quizQuestions.length}`;
            $answersContainer.innerHTML = "";
            const selectedAnswer = state.answers[q.key];
            Object.entries(q.answers).forEach(([key, label]) => {
                const btn = document.createElement("button");
                btn.className = "btn answer-btn";
                btn.dataset.key = key;
                btn.textContent = label;
                if (selectedAnswer === key) btn.classList.add("selected");
                btn.addEventListener("click", () => {
                    state.answers[q.key] = key;
                    $$('.answer-btn').forEach(b => b.classList.remove('selected'));
                    btn.classList.add('selected');
                    updateNavButtons();
                });
                $answersContainer.appendChild(btn);
            });
            updateNavButtons();
        }
        
        function updateNavButtons() {
            const isFirst = state.qIndex === 0;
            const isLast = state.qIndex === quizQuestions.length - 1;
            const hasAnswer = !!state.answers[quizQuestions[state.qIndex].key];
            $backBtn.disabled = isFirst;
            $nextBtn.classList.toggle('hidden', isLast);
            $nextBtn.disabled = !hasAnswer;
            $finishBtn.classList.toggle('hidden', !isLast);
            $finishBtn.disabled = !hasAnswer;
        }

        function onBack() { if (state.qIndex > 0) { state.qIndex--; renderQuestion(); focusH2($questionText); } }
        function onNext() { if (state.qIndex < quizQuestions.length - 1) { state.qIndex++; renderQuestion(); focusH2($questionText); } }
        function onFinish() {
            const result = computeScore(state.answers, state.tools);
            renderResults(result);
            $quiz.classList.add('hidden');
            $results.classList.remove('hidden');
            $newsletter.classList.remove('hidden');
            focusH2($('#results-title'));
        }

        function computeScore(answers, tools) {
            const score = {};
            tools.forEach(t => score[t.id] = 0);
            for (const [qKey, ansKey] of Object.entries(answers)) {
                const mapping = WEIGHTS[qKey]?.[ansKey] || {};
                for (const [toolId, points] of Object.entries(mapping)) {
                    if (score[toolId] !== undefined) score[toolId] += points;
                }
            }
            const enriched = Object.entries(score).map(([id, sc]) => {
                const meta = tools.find(t => t.id === id) || {};
                return { id, score: sc, fit: Number(meta.fit_weight ?? 0), tool: meta };
            });
            enriched.sort((a, b) => (b.score - a.score) || (b.fit - a.fit) || a.id.localeCompare(b.id));
            return enriched;
        }

        function renderResults(sorted) {
            if (!sorted || sorted.length === 0) {
                $primaryResult.innerHTML = `<p class="status-err">Nepodařilo se vyhodnotit výsledek.</p>`;
                return;
            }
            const [primary, ...secondary] = sorted;
            $primaryResult.innerHTML = createToolCard(primary, true);
            $secondaryResults.innerHTML = secondary.slice(0, 2).map(item => createToolCard(item, false)).join('');
            $catalogList.innerHTML = sorted.map(item => createToolCard(item, false)).join('');
        }

        function createToolCard(item, isPrimary) {
            const t = item.tool || {};
            const scoreClass = item.score > 10 ? 'ok' : item.score > 6 ? 'warn' : 'err';
            return `
                <div class="result-card ${isPrimary ? 'primary' : ''}">
                    <div class="header">
                        <div class="header-title">
                            <div class="logo-icon">${toolIcons[t.id] || toolIcons.default}</div>
                            <div>
                                <h4>${escapeHtml(t.name || item.id)}</h4>
                                <span class="archetype-pill">${escapeHtml(t.archetype)}</span>
                            </div>
                        </div>
                        <span class="score-badge ${scoreClass}">Skóre: ${item.score}</span>
                    </div>
                    <p>${escapeHtml(t.summary)}</p>
                    <strong>Ideální pro vás, pokud:</strong>
                    <p>${escapeHtml(t.idealFor)}</p>
                    <strong>Na co si dát pozor:</strong>
                    <p>${escapeHtml(t.watchOutFor)}</p>
                    <div class="kpi-scores">
                        <span>Mkt: <strong>${t.strengths?.marketing || '-'}/5</strong></span>
                        <span>Analýza: <strong>${t.strengths?.analysis || '-'}/5</strong></span>
                        <span>Autom.: <strong>${t.strengths?.automation || '-'}/5</strong></span>
                    </div>
                </div>
            `;
        }
        
        async function onNewsletterSubmit(e) {
            e.preventDefault();
            const email = $emailInput.value.trim();
            $newsletterStatus.textContent = "";
            if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
                $newsletterStatus.textContent = "Zadejte prosím platný e-mail.";
                $newsletterStatus.className = 'status-err';
                return;
            }
            try {
                if (NEWSLETTER_ENDPOINT) { /* Kód pro odeslání na server */ } 
                else {
                    const emails = JSON.parse(localStorage.getItem("ai-kompas-emails") || "[]");
                    if (!emails.includes(email)) emails.push(email);
                    localStorage.setItem("ai-kompas-emails", JSON.stringify(emails));
                }
                $newsletterStatus.textContent = "Děkujeme! Jste přihlášeni.";
                $newsletterStatus.className = 'status-ok';
                $emailInput.value = "";
            } catch(err) {
                $newsletterStatus.textContent = "Došlo k chybě, zkuste to prosím znovu.";
                $newsletterStatus.className = 'status-err';
            }
        }

        function focusH2(el) { if (!el) return; el.setAttribute("tabindex", "-1"); el.focus({ preventScroll: true }); el.removeAttribute("tabindex"); }
        function escapeHtml(str = "") { return String(str).replace(/[&<>"']/g, m => ({ '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#039;' })[m]); }
        function getFallbackTools() {
            return [
                { id:"chatgpt", name:"ChatGPT", fit_weight: 5, archetype: "Kreativec", strengths:{marketing:5,analysis:4,automation:4}, summary:"Univerzální nástroj pro tvorbu obsahu a nápadů.", idealFor:"Rychlé generování textů a kreativní brainstorming.", watchOutFor:"Občasné faktické chyby (halucinace)." },
                { id:"gemini", name:"Gemini", fit_weight: 4, archetype: "Analytik", strengths:{marketing:4,analysis:5,automation:4}, summary:"Multimodální model, silný v analýze a propojení s Google.", idealFor:"Analýzu dat a práci v ekosystému Google.", watchOutFor:"Méně odvážné kreativní výstupy." },
                { id:"claude", name:"Claude", fit_weight: 4, archetype: "Systematik", strengths:{marketing:4,analysis:4,automation:5}, summary:"Spolehlivý pro práci s dlouhými texty a dokumenty.", idealFor:"Sumarizace knih, smluv a rozsáhlých reportů.", watchOutFor:"Může být pomalejší při zpracování." },
                { id:"perplexity", name:"Perplexity", fit_weight: 3, archetype: "Výzkumník", strengths:{marketing:3,analysis:5,automation:2}, summary:"Odpovědi se zdroji, ideální pro rešerše.", idealFor:"Rešerše, ověřování faktů a akademickou práci.", watchOutFor:"Není určen pro kreativní psaní." },
                { id:"grok", name:"Grok", fit_weight: 2, archetype: "Inovátor", strengths:{marketing:2,analysis:5,automation:3}, summary:"Real-time data ze sítě X a osobitý humor.", idealFor:"Analýzu aktuálních trendů a social media monitoring.", watchOutFor:"Jeho styl nemusí být vhodný pro formální komunikaci." }
            ];
        }
        init();
    });
    </script>
</body>
</html>
